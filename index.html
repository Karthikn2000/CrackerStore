<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Store</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
:root{--orange:#ff6f00;--dark:#111;--muted:#666}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Arial;background:#000}
body{
  background:url('images/bg.png') no-repeat center fixed;
  background-size:cover;color:#111
}
canvas#fw{position:fixed;inset:0;z-index:-1}
header{
  position:fixed;top:0;left:0;right:0;height:56px;
  background:linear-gradient(90deg,var(--orange),#ff3d00);
  color:#fff;display:flex;align-items:center;justify-content:center;
  font-size:20px;font-weight:800;z-index:40
}
.top2{
  position:fixed;top:56px;left:0;right:0;height:64px;
  background:rgba(255,111,0,.95);
  display:flex;align-items:center;justify-content:center;
  gap:16px;z-index:40
}
.search-wrap{
  background:#fff;border-radius:28px;padding:6px 10px;
  display:flex;align-items:center;width:520px;max-width:70%
}
.search-wrap input{border:0;outline:0;width:100%;font-size:15px}
#cartBtn{
  position:absolute;right:18px;top:10px;
  background:#fff;border:0;border-radius:20px;
  padding:8px 12px;font-weight:800;color:var(--orange)
}
#cartBadge{
  background:red;color:#fff;border-radius:50%;
  width:22px;height:22px;display:inline-flex;
  align-items:center;justify-content:center;margin-left:6px;
  visibility:hidden
}
.layout{display:flex;padding-top:130px;gap:12px}
.sidebar{
  width:190px;padding:12px;position:sticky;top:120px;
  height:calc(100vh - 120px);
  background:rgba(255,255,255,.06);border-radius:8px
}
.sidebar button{
  width:100%;margin-bottom:10px;padding:10px;
  border:0;border-radius:8px;
  background:linear-gradient(90deg,#ff8a50,#ff5722);
  color:#fff;font-weight:700
}
.sidebar button.active{outline:3px solid rgba(255,255,255,.2)}
.grid{
  flex:1;display:grid;
  grid-template-columns:repeat(auto-fit,minmax(180px,1fr));
  gap:12px;padding:12px
}
.card{
  background:#fff;border-radius:10px;padding:10px;
  display:flex;flex-direction:column;justify-content:space-between
}
.card img{width:100%;height:130px;object-fit:cover;border-radius:8px}
.name{font-weight:700;margin-top:8px;font-size:14px}
.price{font-weight:700;color:var(--muted)}
.qty{display:flex;justify-content:center;gap:8px;margin-top:8px}
.qty button{
  width:30px;height:30px;border-radius:8px;
  background:var(--orange);color:#fff;border:0;font-size:18px
}
.qty span{min-width:26px;text-align:center;font-weight:800}
#cartPanel{
  position:fixed;right:0;top:0;width:360px;height:100%;
  background:#fff;transform:translateX(100%);
  transition:.25s;z-index:60;display:flex;flex-direction:column
}
#cartPanel.open{transform:translateX(0)}
.cart-header{padding:12px;border-bottom:1px solid #eee;
  display:flex;justify-content:space-between}
.cart-body{flex:1;overflow:auto;padding:12px}
.cart-footer{border-top:1px solid #eee;padding:12px}
.cart-row{display:flex;justify-content:space-between;margin-bottom:8px}
</style>
</head>

<body>

<canvas id="fw"></canvas>

<header id="storeName">Store</header>

<div class="top2">
  <div class="search-wrap">
    üîç <input id="searchInput" placeholder="Search">
  </div>
  <button id="cartBtn">üõí <span id="cartBadge">0</span></button>
</div>

<div class="layout">
  <aside class="sidebar" id="sidebar"></aside>
  <main class="grid" id="grid"></main>
</div>

<aside id="cartPanel">
  <div class="cart-header">
    <b>Cart</b>
    <button onclick="toggleCart()">‚úï</button>
  </div>
  <div class="cart-body" id="cartList"></div>
  <div class="cart-footer">
    <div id="cartTotal"></div>
    <button id="orderBtn"></button>
  </div>
</aside>

<script>
/* üî• FIREBASE CONFIG */
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_DOMAIN",
  databaseURL: "YOUR_DB_URL",
  projectId: "YOUR_PROJECT_ID"
});
const db = firebase.database();

let SETTINGS={}, PRODUCTS={}, CART={};

/* SETTINGS */
db.ref("settings").on("value",s=>{
  SETTINGS=s.val()||{};
  storeName.innerText=SETTINGS.storeName||"Store";
  orderBtn.innerText=SETTINGS.placeOrderText||"Order";
});

/* CATEGORIES */
db.ref("categories").on("value",snap=>{
  sidebar.innerHTML="";
  snap.forEach(c=>{
    const b=document.createElement("button");
    b.innerText=c.val();
    b.onclick=()=>filterCat(c.key);
    sidebar.appendChild(b);
  });
});

/* PRODUCTS */
db.ref("products").on("value",snap=>{
  PRODUCTS={}; grid.innerHTML="";
  snap.forEach(p=>{
    const d=p.val(); PRODUCTS[p.key]=d; CART[p.key]=CART[p.key]||0;
    const card=document.createElement("div");
    card.className="card";
    card.dataset.cat=d.category;
    card.dataset.name=d.name.toLowerCase();
    card.innerHTML=`
      <img src="${d.image}">
      <div class="name">${d.name}</div>
      <div class="price">${SETTINGS.currency||"‚Çπ"}${d.price}</div>
      <div class="qty">
        <button onclick="addQty('${p.key}',-1)">-</button>
        <span id="q-${p.key}">${CART[p.key]}</span>
        <button onclick="addQty('${p.key}',1)">+</button>
      </div>`;
    grid.appendChild(card);
  });
});

/* QTY */
function addQty(id,d){
  CART[id]=Math.max(0,CART[id]+d);
  document.getElementById("q-"+id).innerText=CART[id];
  updateCart();
}

/* CART */
function updateCart(){
  cartList.innerHTML="";
  let total=0,count=0;
  for(let id in CART){
    if(CART[id]>0){
      const p=PRODUCTS[id];
      total+=p.price*CART[id]; count+=CART[id];
      cartList.innerHTML+=`
      <div class="cart-row">
        <div>
          <button onclick="addQty('${id}',-1)">-</button>
          ${p.name} x ${CART[id]}
          <button onclick="addQty('${id}',1)">+</button>
        </div>
        <div>${SETTINGS.currency||"‚Çπ"}${p.price*CART[id]}</div>
      </div>`;
    }
  }
  cartTotal.innerText="Total: "+(SETTINGS.currency||"‚Çπ")+total;
  cartBadge.style.visibility=count? "visible":"hidden";
  cartBadge.innerText=count;
}

/* FILTER */
function filterCat(cat){
  document.querySelectorAll(".card").forEach(c=>{
    c.style.display=(cat==="all"||c.dataset.cat===cat)?"":"none";
  });
}

/* CART TOGGLE */
cartBtn.onclick=toggleCart;
function toggleCart(){
  cartPanel.classList.toggle("open");
}

/* ORDER */
orderBtn.onclick=()=>{
  let msg="Order:\n";
  for(let id in CART) if(CART[id]>0)
    msg+=PRODUCTS[id].name+" x "+CART[id]+"\n";
  window.open(`https://wa.me/${SETTINGS.whatsappNumber}?text=${encodeURIComponent(msg)}`);
};

/* SEARCH */
searchInput.oninput=e=>{
  const t=e.target.value.toLowerCase();
  document.querySelectorAll(".card").forEach(c=>{
    c.style.display=c.dataset.name.includes(t)?"":"none";
  });
};

/* FIREWORKS (UNCHANGED) */
const fw=document.getElementById("fw"),ctx=fw.getContext("2d");
function rs(){fw.width=innerWidth;fw.height=innerHeight}rs();
window.onresize=rs;let P=[];
setInterval(()=>{const x=Math.random()*fw.width,y=Math.random()*fw.height/2;
for(let i=0;i<50;i++)P.push({x,y,vx:Math.cos(i)*3,vy:Math.sin(i)*3,l:50})},800);
(function a(){
ctx.clearRect(0,0,fw.width,fw.height);
P.forEach(p=>{p.x+=p.vx;p.y+=p.vy;p.l--;ctx.fillStyle="orange";
ctx.fillRect(p.x,p.y,2,2)});
P=P.filter(p=>p.l>0);requestAnimationFrame(a);
})();
</script>
</body>
</html>







